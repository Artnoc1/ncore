#include <cxxtest/TestSuite.h>
#include <Commands.h>
#include <LineParser.h>

using std::string;
using std::vector;

bool return_true(const vector<string>&)
{
  return true;
}

class CommandsTestSuite: public CxxTest::TestSuite
{
  LineParser parser;
public:
  void setUp()
  {
    parser.clear();
  }

  void testEmptyBlank( void )
  {
    bool result = Commands().execute(vector<string>());

    TS_ASSERT_EQUALS( result, false );
  }
  void testEmptyWithCommand( void )
  {
    parser.parse("test");
    bool result = Commands().execute(parser);
    
    TS_ASSERT_EQUALS( result, false );
  }
  void testAddWorker( void )
  {
    Commands commands;
    bool ok = commands.add("cantfindme",return_true);

    TS_ASSERT_EQUALS( ok, true );
  }
  void testAddDuplicateWorker( void )
  {
    Commands commands;
    commands.add("cantfindme",return_true);
    bool ok = commands.add("cantfindme",return_true);

    TS_ASSERT_EQUALS( ok, false );
  }

  void testWorkerNotFound( void )
  {
    Commands commands;
    commands.add("cantfindme",return_true);
    
    parser.parse("test");
    bool result = Commands().execute(parser);

    TS_ASSERT_EQUALS( result, false );
  }

  void testWorkerDispatchOk( void )
  {
    Commands commands;
    commands.add("test",return_true);
    
    parser.parse("test");
    bool result = commands.execute(parser);

    TS_ASSERT_EQUALS( result, true );
  }
};
// vim:cin:ai:sts=2 sw=2 ft=cpp
